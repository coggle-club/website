<!-- Coggle 30 Days of MLï¼ˆ24å¹´1/2æœˆï¼‰ -->
<!-- 30å¤©å…¥é—¨æ•°æ®ç«èµ› -->
<!-- 2023-01-18 -->
<!-- <a target="_blank" href="https://www.zhihu.com/people/ashui233/">é˜¿æ°´</a>, <a target="_blank" href="https://www.zhihu.com/people/wang-he-13-93">é±¼é‡é›¨æ¬²è¯­ä¸ä½™</a>-->
<!-- <a href="https://coggle.club/blog/30days-of-ml-202401">å­¦ä¹ èµ„æ–™</a>##<a href="https://shimo.im/forms/sUvnh7XGiHHRV3MI/fill">æ‰“å¡é“¾æ¥</a>-->

## Part1 å†…å®¹ä»‹ç»

åœ¨è‡ªç„¶è¯­è¨€å¤„ç†é¢†åŸŸï¼Œå¤§å‹è¯­è¨€æ¨¡å‹ï¼ˆLLMï¼‰å¦‚GPT-3ã€BERTç­‰å·²ç»å–å¾—äº†æ˜¾è‘—çš„è¿›å±•ï¼Œå®ƒä»¬èƒ½å¤Ÿç”Ÿæˆè¿è´¯ã€è‡ªç„¶çš„æ–‡æœ¬ï¼Œå›ç­”é—®é¢˜ï¼Œå¹¶æ‰§è¡Œå…¶ä»–å¤æ‚çš„è¯­è¨€ä»»åŠ¡ã€‚ç„¶è€Œï¼Œè¿™äº›æ¨¡å‹å­˜åœ¨ä¸€äº›å›ºæœ‰çš„å±€é™æ€§ï¼Œå¦‚â€œæ¨¡å‹å¹»è§‰é—®é¢˜â€ã€â€œæ—¶æ•ˆæ€§é—®é¢˜â€å’Œâ€œæ•°æ®å®‰å…¨é—®é¢˜â€ã€‚ä¸ºäº†å…‹æœè¿™äº›é™åˆ¶ï¼Œæ£€ç´¢å¢å¼ºç”Ÿæˆï¼ˆRAGï¼‰æŠ€æœ¯åº”è¿è€Œç”Ÿã€‚

RAGæŠ€æœ¯ç»“åˆäº†å¤§å‹è¯­è¨€æ¨¡å‹çš„å¼ºå¤§ç”Ÿæˆèƒ½åŠ›å’Œæ£€ç´¢ç³»ç»Ÿçš„ç²¾ç¡®æ€§ã€‚å®ƒå…è®¸æ¨¡å‹åœ¨ç”Ÿæˆæ–‡æœ¬æ—¶ï¼Œä»å¤–éƒ¨çŸ¥è¯†åº“ä¸­æ£€ç´¢ç›¸å…³ä¿¡æ¯ï¼Œä»è€Œæé«˜ç”Ÿæˆå†…å®¹çš„å‡†ç¡®æ€§ã€ç›¸å…³æ€§å’Œæ—¶æ•ˆæ€§ã€‚è¿™ç§æ–¹æ³•ä¸ä»…å¢å¼ºäº†æ¨¡å‹çš„å›ç­”èƒ½åŠ›ï¼Œè¿˜å‡å°‘äº†ç”Ÿæˆé”™è¯¯ä¿¡æ¯çš„é£é™©ã€‚


æœ¬æœˆçš„å­¦ä¹ å†…å®¹ä¸»è¦å›´ç»•æ£€ç´¢å¢å¼ºç”Ÿæˆï¼ˆRAGï¼‰æŠ€æœ¯å±•å¼€ï¼š
- RAGæŠ€æœ¯èƒŒæ™¯ä¸åŠ¨æœº
- RAGæŠ€æœ¯åŸºæœ¬åŸç†å’ŒæŠ€æœ¯æµç¨‹
- çŸ¥è¯†åº“æ„å»ºä¸ç®¡ç†ã€æ£€ç´¢æ¨¡å—æŠ€æœ¯
- ChatGPT/ChatGLMçš„APIä½¿ç”¨

## Part2 æ´»åŠ¨å®‰æ’


* å…è´¹å­¦ä¹ æ´»åŠ¨ï¼Œä¸ä¼šæ”¶å–ä»»ä½•è´¹ç”¨ã€‚
* **è¯·å„ä½åŒå­¦æ·»åŠ ä¸‹é¢å¾®ä¿¡ï¼Œå¹¶å›å¤ã€ç«èµ›å­¦ä¹ ã€‘ï¼Œå³å¯å‚ä¸ã€‚**

![](https://cdn.coggle.club/coggle101_qrcode.jpeg)


## Part3 ç§¯åˆ†è¯´æ˜å’Œå¥–åŠ±

ä¸ºäº†æ¿€åŠ±å„ä½åŒå­¦å®Œæˆçš„å­¦ä¹ ä»»åŠ¡ï¼Œåœ¨å®Œæˆå­¦ä¹ åï¼ˆæœ¬æ¬¡æ´»åŠ¨ï¼Œæˆªæ­¢2æœˆ29ï¼‰ï¼Œå°†æŒ‰ç…§ç§¯åˆ†é¡ºåºè¿›è¡Œè¯„é€‰ Top3 çš„å­¦ä¹ è€…ã€‚å¦‚æœæ‰“å¡ç§¯åˆ†ç›¸åŒï¼Œåˆ™æŒ‰ç…§promptè´¨é‡å’Œæ–‡æœ¬é•¿åº¦è¿›è¡Œæ’åºã€‚

æ‰“å¡åœ°å€ï¼š[https://shimo.im/forms/sUvnh7XGiHHRV3MI/fill](https://shimo.im/forms/sUvnh7XGiHHRV3MI/fill)


### æ‰“å¡ç§¯åˆ†å¥–åŠ±


Top1çš„å­¦ä¹ è€…å°†è·å¾—ä»¥ä¸‹å¥–åŠ±ï¼š

- 50å…ƒç°é‡‘çº¢åŒ…
- Coggle ç«èµ›ä¸“è®¿æœºä¼š

Top2-3çš„å­¦ä¹ è€…å°†è·å¾—ä»¥ä¸‹å¥–åŠ±ï¼š
- 20å…ƒçº¢åŒ…
- Coggle ç«èµ›ä¸“è®¿æœºä¼š


å†å²æ´»åŠ¨æ‰“å¡é“¾æ¥ï¼Œå¯ä»¥å‚è€ƒå¦‚ä¸‹æ ¼å¼ï¼š
- [https://blog.csdn.net/weixin_42551154/article/details/125474519](https://blog.csdn.net/weixin_42551154/article/details/125474519)
- [https://blog.csdn.net/weixin_42551154/article/details/125481695](https://blog.csdn.net/weixin_42551154/article/details/125481695)


## Part4 åŠ¨æ‰‹å­¦RAG

### èƒŒæ™¯ä»‹ç»

æœ¬æ¬¡æ´»åŠ¨å‚èµ›é€‰æ‰‹ä»¥å¤§æ¨¡å‹ä¸ºä¸­å¿ƒåˆ¶ä½œä¸€ä¸ªé—®ç­”ç³»ç»Ÿï¼Œå›ç­”ç”¨æˆ·çš„æ±½è½¦ç›¸å…³é—®é¢˜ã€‚å‚èµ›é€‰æ‰‹éœ€è¦æ ¹æ®é—®é¢˜ï¼Œåœ¨æ–‡æ¡£ä¸­å®šä½ç›¸å…³ä¿¡æ¯çš„ä½ç½®ï¼Œå¹¶æ ¹æ®æ–‡æ¡£å†…å®¹é€šè¿‡å¤§æ¨¡å‹ç”Ÿæˆç›¸åº”çš„ç­”æ¡ˆã€‚æ¶‰åŠçš„é—®é¢˜ä¸»è¦å›´ç»•æ±½è½¦ä½¿ç”¨ã€ç»´ä¿®ã€ä¿å…»ç­‰æ–¹é¢ã€‚

```
é—®é¢˜1ï¼šæ€ä¹ˆæ‰“å¼€å±é™©è­¦å‘Šç¯ï¼Ÿ
ç­”æ¡ˆ1ï¼šå±é™©è­¦å‘Šç¯å¼€å…³åœ¨æ–¹å‘ç›˜ä¸‹æ–¹ï¼ŒæŒ‰ä¸‹å¼€å…³å³å¯æ‰“å¼€å±é™©è­¦å‘Šç¯ã€‚

é—®é¢˜2ï¼šè½¦è¾†å¦‚ä½•ä¿å…»ï¼Ÿ
ç­”æ¡ˆ2ï¼šä¸ºäº†ä¿æŒè½¦è¾†å¤„äºæœ€ä½³çŠ¶æ€ï¼Œå»ºè®®æ‚¨å®šæœŸå…³æ³¨è½¦è¾†çŠ¶æ€ï¼ŒåŒ…æ‹¬å®šæœŸä¿å…»ã€æ´—è½¦ã€å†…éƒ¨æ¸…æ´ã€å¤–éƒ¨æ¸…æ´ã€è½®èƒçš„ä¿å…»ã€ä½å‹è“„ç”µæ± çš„ä¿å…»ç­‰ã€‚

é—®é¢˜3ï¼šé èƒŒå¤ªçƒ­æ€ä¹ˆåŠï¼Ÿ
ç­”æ¡ˆ3ï¼šæ‚¨å¥½ï¼Œå¦‚æœæ‚¨çš„åº§æ¤…é èƒŒå¤ªçƒ­ï¼Œå¯ä»¥å°è¯•å…³é—­åº§æ¤…åŠ çƒ­åŠŸèƒ½ã€‚åœ¨å¤šåª’ä½“æ˜¾ç¤ºå±ä¸Šä¾æ¬¡ç‚¹å‡»ç©ºè°ƒå¼€å¯æŒ‰é”®â†’åº§æ¤…â†’åŠ çƒ­ï¼Œåœ¨è¯¥ç•Œé¢ä¸‹å¯ä»¥å…³é—­åº§æ¤…åŠ çƒ­ã€‚
```

### æ‰“å¡ä»»åŠ¡
| ä»»åŠ¡åç§°                                        | æ‰€éœ€æŠ€èƒ½             |
| ----------------------------------------------- | -------------------- |
| ä»»åŠ¡1ï¼šåˆå§‹RAG              | æ—                |
| ä»»åŠ¡2ï¼šChatGPT/GLM APIä½¿ç”¨             | Python               |
| ä»»åŠ¡3ï¼šè¯»å–æ±½è½¦é—®ç­”æ•°æ®              | Python               |
| ä»»åŠ¡4ï¼šæ–‡æœ¬ç´¢å¼•ä¸ç­”æ¡ˆæ£€ç´¢              | TFIDFã€BM25               |
| ä»»åŠ¡5ï¼šæ–‡æœ¬åµŒå…¥ä¸å‘é‡æ£€ç´¢              | Embeddingã€transformer               |
| ä»»åŠ¡6ï¼šæ–‡æœ¬å¤šè·¯å¬å›ä¸é‡æ’åº              | ReRank               |
| ä»»åŠ¡7ï¼šæ–‡æœ¬é—®ç­”Promoptä¼˜åŒ–              | Python               |
| ä»»åŠ¡8ï¼šé—®ç­”æ„å›¾è¯†åˆ«ï¼ˆè¿›é˜¶æ–¹å‘ï¼‰              | BERT/TFIDF               |
| ä»»åŠ¡9ï¼šé—®ç­”å…³é”®è¯æå–ï¼ˆè¿›é˜¶æ–¹å‘ï¼‰              | TextRank               |
| ä»»åŠ¡10ï¼šæ‰©å±•è¯ä¸æ‰©å±•æŸ¥è¯¢ï¼ˆè¿›é˜¶æ–¹å‘ï¼‰              | Word2Vec/BART               |
| ä»»åŠ¡11ï¼šæœ¬åœ°å¾®è°ƒChatGLMï¼ˆè¿›é˜¶æ–¹å‘ï¼‰              | ChatGLM               |

### ä»»åŠ¡1ï¼šåˆå§‹RAG

- ä»»åŠ¡è¯´æ˜ï¼šäº†è§£åˆ°ç°æœ‰å¤§æ¨¡å‹çš„ç¼ºé™·å’ŒRAGçš„ä¼˜ç‚¹å’Œæµç¨‹
- ä»»åŠ¡è¦æ±‚ï¼š
    - äº†è§£å¤§æ¨¡å‹ç°æœ‰çš„ç¼ºç‚¹
    - ç†è§£RAGçš„æµç¨‹å’Œå®ç°æ­¥éª¤
    - æ¸…æ¥šRAGçš„éœ€è¦çš„æŠ€æœ¯
- æ‰“å¡è¦æ±‚ï¼šé˜…è¯»LangChainä¸RAGçš„[æ–‡ç« ](https://juejin.cn/post/7310569308916334604)å’ŒLangChainçš„[å®˜æ–¹æ–‡æ¡£](https://python.langchain.com/docs/expression_language/cookbook/retrieval)ï¼Œåˆ—ä¸¾LangChainèƒ½å®ç°çš„åŠŸèƒ½ã€‚

> å¤§æ¨¡å‹çš„å±€é™æ€§

å¤§å‹è¯­è¨€æ¨¡å‹åœ¨è‡ªç„¶è¯­è¨€å¤„ç†é¢†åŸŸå±•ç¤ºäº†æ˜¾è‘—çš„èƒ½åŠ›ï¼Œä½†å®ƒä»¬ä¹Ÿå­˜åœ¨ä¸€ç³»åˆ—å›ºæœ‰çš„ç¼ºç‚¹ã€‚é¦–å…ˆï¼Œè™½ç„¶è¿™äº›æ¨¡å‹åœ¨æŒæ¡å¤§é‡ä¿¡æ¯æ–¹é¢éå¸¸æœ‰æ•ˆï¼Œä½†å®ƒä»¬çš„ç»“æ„å’Œå‚æ•°æ•°é‡ä½¿å¾—å¯¹å…¶è¿›è¡Œä¿®æ”¹ã€å¾®è°ƒæˆ–é‡æ–°è®­ç»ƒå˜å¾—å¼‚å¸¸å›°éš¾ï¼Œä¸”ç›¸å…³æˆæœ¬ç›¸å½“å¯è§‚ã€‚

å…¶æ¬¡ï¼Œå¤§å‹è¯­è¨€æ¨¡å‹çš„åº”ç”¨å¾€å¾€ä¾èµ–äºæ„å»ºé€‚å½“çš„æç¤ºï¼ˆpromptï¼‰æ¥å¼•å¯¼æ¨¡å‹ç”Ÿæˆæ‰€éœ€çš„æ–‡æœ¬ã€‚è¿™ç§æ–¹æ³•é€šè¿‡å°†ä¿¡æ¯åµŒå…¥åˆ°æç¤ºä¸­ï¼Œä»è€Œå¼•å¯¼æ¨¡å‹æŒ‰ç…§ç‰¹å®šçš„æ–¹å‘ç”Ÿæˆæ–‡æœ¬ã€‚ç„¶è€Œï¼Œè¿™ç§åŸºäºæç¤ºçš„æ–¹æ³•å¯èƒ½ä½¿æ¨¡å‹è¿‡äºä¾èµ–å…ˆå‰è§è¿‡çš„æ¨¡å¼ï¼Œè€Œæ— æ³•çœŸæ­£ç†è§£é—®é¢˜çš„æœ¬è´¨ã€‚

| **å¤§æ¨¡å‹ç°å­˜é—®é¢˜** | å¤§å‹è¯­è¨€æ¨¡å‹çš„å±€é™æ€§ |
|----------|------------------------|
| é—®é¢˜1.1  | æ¨¡å‹å¹»è§‰é—®é¢˜ï¼šç”Ÿæˆå†…å®¹å¯èƒ½ä¸å‡†ç¡®æˆ–ä¸ä¸€è‡´ |
| é—®é¢˜1.2  | æ—¶æ•ˆæ€§é—®é¢˜ï¼šç”Ÿæˆçš„å†…å®¹ä¸å…·æœ‰å½“å‰æ—¶æ•ˆæ€§ |
| é—®é¢˜1.3  | æ•°æ®å®‰å…¨é—®é¢˜ï¼šå¯èƒ½å­˜åœ¨æ•æ„Ÿä¿¡æ¯æ³„éœ²é£é™© |

åœ¨è‡ªç„¶è¯­è¨€å¤„ç†é¢†åŸŸï¼Œå¹»è§‰ï¼ˆHallucinationï¼‰è¢«å®šä¹‰ä¸ºç”Ÿæˆçš„å†…å®¹ä¸æä¾›çš„æºå†…å®¹æ— å…³æˆ–ä¸å¿ å®ï¼Œå…·ä½“è€Œè¨€ï¼Œæ˜¯ä¸€ç§è™šå‡çš„æ„ŸçŸ¥ï¼Œä½†åœ¨è¡¨é¢ä¸Šå´ä¼¼ä¹æ˜¯çœŸå®çš„ã€‚åœ¨ä¸€èˆ¬è¯­å¢ƒä¸­ï¼Œå¹»è§‰æ˜¯ä¸€ä¸ªå¿ƒç†å­¦æœ¯è¯­ï¼ŒæŒ‡çš„æ˜¯ä¸€ç§ç‰¹å®šç±»å‹çš„æ„ŸçŸ¥ã€‚åœ¨è‡ªç„¶è¯­è¨€å¤„ç†æˆ–å¤§å‹è¯­è¨€æ¨¡å‹çš„è¯­å¢ƒä¸‹ï¼Œè¿™ç§æ„ŸçŸ¥å³ä¸ºä¸€ç§è™šå‡çš„ã€ä¸ç¬¦åˆå®é™…çš„ä¿¡æ¯ã€‚

é€ æˆå¹»è§‰çš„åŸå› ä¸»è¦å¯ä»¥å½’ç»“ä¸ºæ•°æ®é©±åŠ¨åŸå› ã€è¡¨ç¤ºå’Œè§£ç çš„ä¸å®Œå–„ä»¥åŠå‚æ•°çŸ¥è¯†åè§ã€‚é¦–å…ˆï¼Œæ•°æ®å¯¹ä¸é½æˆ–ä¸åŒ¹é…å¯èƒ½å¯¼è‡´å¹»è§‰ï¼Œå› ä¸ºæ¨¡å‹åœ¨è®­ç»ƒä¸­æœªèƒ½å‡†ç¡®åœ°ç†è§£æºå†…å®¹ä¸å‚è€ƒå†…å®¹ä¹‹é—´çš„å…³ç³»ã€‚

> çŸ¥è¯†åº“é—®ç­”ï¼ˆKnowledge Base Question Answeringï¼ŒKBQAï¼‰

çŸ¥è¯†åº“é—®ç­”ï¼ˆKnowledge Base Question Answeringï¼Œç®€ç§°KBQAï¼‰æ˜¯ä¸€ç§æ—©æœŸçš„å¯¹è¯ç³»ç»Ÿæ–¹æ³•ï¼Œæ—¨åœ¨åˆ©ç”¨ç»“æ„åŒ–çš„çŸ¥è¯†åº“è¿›è¡Œè‡ªç„¶è¯­è¨€é—®é¢˜çš„å›ç­”ã€‚è¿™ç§æ–¹æ³•åŸºäºä¸€ä¸ªå­˜å‚¨åœ¨å›¾æ•°æ®åº“ä¸­çš„çŸ¥è¯†åº“ï¼Œé€šå¸¸ä»¥ä¸‰å…ƒç»„çš„å½¢å¼è¡¨ç¤ºä¸º<ä¸»é¢˜ï¼Œå…³ç³»ï¼Œå¯¹è±¡>ï¼Œå…¶ä¸­æ¯ä¸ªä¸‰å…ƒç»„éƒ½é™„å¸¦ç›¸å…³çš„å±æ€§ä¿¡æ¯ã€‚

çŸ¥è¯†åº“é—®ç­”æ—©æœŸæ˜¯å¯¹è¯ç³»ç»Ÿä¸­çš„æœ‰æ•ˆæ–¹æ³•ï¼Œå…¶åŸºäºçŸ¥è¯†å›¾è°±çš„ç»“æ„ä¸ºç³»ç»Ÿæä¾›äº†ä¸°å¯Œçš„è¯­ä¹‰ä¿¡æ¯ï¼Œä½¿å¾—ç³»ç»Ÿèƒ½å¤Ÿæ›´æ·±å…¥åœ°ç†è§£ç”¨æˆ·æå‡ºçš„é—®é¢˜ï¼Œå¹¶ä»¥ç»“æ„åŒ–çš„å½¢å¼å›ç­”è¿™äº›é—®é¢˜ã€‚éšç€æŠ€æœ¯çš„ä¸æ–­å‘å±•ï¼ŒKBQAæ–¹æ³•ä¹Ÿåœ¨ä¸æ–­æ¼”è¿›ï¼Œä¸ºå¯¹è¯ç³»ç»Ÿçš„è¿›ä¸€æ­¥æå‡å¥ å®šäº†åŸºç¡€ã€‚

åœ¨KBQAä¸­ï¼Œæœ‰ä¸¤ç§ä¸»æµæ–¹æ³•ç”¨äºå¤„ç†è‡ªç„¶è¯­è¨€é—®é¢˜ï¼š
- ä¸»é¢˜è¯†åˆ«ä¸å®ä½“é“¾æ¥ï¼šè¯¥æ–¹æ³•ä»è¯†åˆ«é—®é¢˜ä¸­çš„ä¸»é¢˜å¼€å§‹ï¼Œå°†å…¶é“¾æ¥åˆ°çŸ¥è¯†åº“ä¸­çš„å®ä½“ï¼ˆç§°ä¸ºä¸»é¢˜å®ä½“ï¼‰ã€‚é€šè¿‡ä¸»é¢˜å®ä½“ï¼Œç³»ç»Ÿèƒ½å¤Ÿåœ¨çŸ¥è¯†åº“ä¸­æŸ¥æ‰¾ç›¸å…³çš„ä¿¡æ¯å¹¶å›ç­”é—®é¢˜ã€‚
- å¤šè·³æŸ¥è¯¢ï¼šåŸºäºå›¾æ•°æ®åº“çš„ä¼˜åŠ¿ï¼ŒKBQAèƒ½å¤Ÿè¿›è¡Œå¤šè·³æŸ¥è¯¢ï¼Œå³é€šè¿‡å¤šä¸ªå…³ç³»è·¨è¶Šå¤šä¸ªå®ä½“æ¥è·å–æ›´æ·±å±‚æ¬¡çš„ä¿¡æ¯ã€‚è¿™ç§çµæ´»æ€§ä½¿å¾—ç³»ç»Ÿèƒ½å¤Ÿæ›´å…¨é¢åœ°ç†è§£å’Œå›ç­”ç”¨æˆ·çš„å¤æ‚é—®é¢˜ã€‚

> RAGä»‹ç»

æ£€ç´¢å¢å¼ºç”Ÿæˆï¼ˆRAGï¼‰æŠ€æœ¯åœ¨å¼¥è¡¥å¤§å‹è¯­è¨€æ¨¡å‹ï¼ˆLLMï¼‰çš„å±€é™æ€§æ–¹é¢å–å¾—äº†æ˜¾è‘—è¿›å±•ï¼Œå°¤å…¶æ˜¯åœ¨è§£å†³å¹»è§‰é—®é¢˜å’Œæå‡å®æ•ˆæ€§æ–¹é¢ã€‚åœ¨ä¹‹å‰æåˆ°çš„LLMå­˜åœ¨çš„é—®é¢˜ä¸­ï¼Œç‰¹åˆ«æ˜¯å¹»è§‰é—®é¢˜å’Œæ—¶æ•ˆæ€§é—®é¢˜ï¼ŒRAGæŠ€æœ¯é€šè¿‡å¼•å…¥å¤–éƒ¨çŸ¥è¯†åº“çš„æ£€ç´¢æœºåˆ¶ï¼ŒæˆåŠŸæå‡äº†ç”Ÿæˆå†…å®¹çš„å‡†ç¡®æ€§ã€ç›¸å…³æ€§å’Œæ—¶æ•ˆæ€§ã€‚

- RAGæŠ€æœ¯é€šè¿‡æ£€ç´¢å¤–éƒ¨çŸ¥è¯†åº“ï¼Œé¿å…äº†å¹»è§‰é—®é¢˜çš„å›°æ‰°ã€‚ç›¸è¾ƒäºå•çº¯ä¾èµ–å¤§å‹è¯­è¨€æ¨¡å‹å¯¹æµ·é‡æ–‡æœ¬æ•°æ®çš„å­¦ä¹ ï¼ŒRAGå…è®¸æ¨¡å‹åœ¨ç”Ÿæˆæ–‡æœ¬æ—¶ä»äº‹å®ä¸°å¯Œçš„å¤–éƒ¨çŸ¥è¯†åº“ä¸­æ£€ç´¢ç›¸å…³ä¿¡æ¯ã€‚
- RAGæŠ€æœ¯çš„æ—¶æ•ˆæ€§ä¼˜åŠ¿ä½¿å…¶åœ¨å¤„ç†å®æ•ˆæ€§è¾ƒå¼ºçš„é—®é¢˜æ—¶æ›´ä¸ºå¯é ã€‚é€šè¿‡ä¸å¤–éƒ¨çŸ¥è¯†åº“çš„è¿æ¥ï¼ŒRAGç¡®ä¿äº†æ¨¡å‹å¯ä»¥è·å–æœ€æ–°çš„ä¿¡æ¯ï¼ŒåŠæ—¶é€‚åº”å½“å‰çš„äº‹ä»¶å’ŒçŸ¥è¯†ã€‚
- ä¸ä¼ ç»Ÿçš„çŸ¥è¯†åº“é—®ç­”ï¼ˆKBQAï¼‰ç›¸æ¯”ï¼ŒRAGæŠ€æœ¯åœ¨çŸ¥è¯†æ£€ç´¢æ–¹é¢æ›´åŠ çµæ´»ï¼Œä¸ä»…èƒ½å¤Ÿä»ç»“æ„åŒ–çš„çŸ¥è¯†åº“ä¸­æ£€ç´¢ä¿¡æ¯ï¼Œè¿˜èƒ½å¤Ÿåº”å¯¹éç»“æ„åŒ–çš„è‡ªç„¶è¯­è¨€æ–‡æœ¬ã€‚


| **RAGä¼˜ç‚¹** | æè¿° |
|-----------------|-----|
| ä¼˜ç‚¹1.1         | æé«˜å‡†ç¡®æ€§å’Œç›¸å…³æ€§ |
| ä¼˜ç‚¹1.2         | æ”¹å–„æ—¶æ•ˆæ€§ï¼Œä½¿æ¨¡å‹é€‚åº”å½“å‰äº‹ä»¶å’ŒçŸ¥è¯† |
| ä¼˜ç‚¹1.3         | é™ä½ç”Ÿæˆé”™è¯¯é£é™©ï¼Œä¾èµ–æ£€ç´¢ç³»ç»Ÿæä¾›çš„å‡†ç¡®ä¿¡æ¯ |

**RAGè¢«æ„å»ºä¸ºä¸€ä¸ªåº”ç”¨äºå¤§å‹è¯­è¨€æ¨¡å‹çš„æ¡†æ¶ï¼Œå…¶ç›®æ ‡æ˜¯é€šè¿‡ç»“åˆå¤§æ¨¡å‹çš„ç”Ÿæˆèƒ½åŠ›å’Œå¤–éƒ¨çŸ¥è¯†åº“çš„æ£€ç´¢æœºåˆ¶ï¼Œæå‡è‡ªç„¶è¯­è¨€å¤„ç†ä»»åŠ¡çš„æ•ˆæœã€‚** RAGå¹¶éæ—¨åœ¨å–ä»£å·²æœ‰çš„çŸ¥è¯†åº“é—®ç­”ï¼ˆKBQAï¼‰ç³»ç»Ÿï¼Œè€Œæ˜¯ä½œä¸ºä¸€ç§è¡¥å……ï¼Œåˆ©ç”¨æ£€ç´¢æœºåˆ¶å¼ºè°ƒå®æ—¶æ€§å’Œå‡†ç¡®æ€§ï¼Œä»è€Œå¼¥è¡¥å¤§å‹è¯­è¨€æ¨¡å‹å›ºæœ‰çš„å±€é™æ€§ã€‚

RAGæ¡†æ¶çš„æœ€ç»ˆè¾“å‡ºè¢«è®¾è®¡ä¸ºä¸€ç§ååŒå·¥ä½œæ¨¡å¼ï¼Œå°†æ£€ç´¢åˆ°çš„çŸ¥è¯†èåˆåˆ°å¤§å‹è¯­è¨€æ¨¡å‹çš„ç”Ÿæˆè¿‡ç¨‹ä¸­ã€‚åœ¨åº”å¯¹ä»»åŠ¡ç‰¹å®šé—®é¢˜æ—¶ï¼ŒRAGä¼šç”Ÿæˆä¸€æ®µæ ‡å‡†åŒ–çš„å¥å­ï¼Œå¼•å¯¼å¤§æ¨¡å‹è¿›è¡Œå›ç­”ã€‚ä¸‹é¢æ˜¯RAGè¾“å‡ºåˆ°å¤§å‹è¯­è¨€æ¨¡å‹çš„å…¸å‹æ¨¡æ¿ï¼š

```
ä½ æ˜¯ä¸€ä¸ª{task}æ–¹é¢çš„ä¸“å®¶ï¼Œè¯·ç»“åˆç»™å®šçš„èµ„æ–™ï¼Œå¹¶å›ç­”æœ€ç»ˆçš„é—®é¢˜ã€‚è¯·å¦‚å®å›ç­”ï¼Œå¦‚æœé—®é¢˜åœ¨èµ„æ–™ä¸­æ‰¾ä¸åˆ°ç­”æ¡ˆï¼Œè¯·å›ç­”ä¸çŸ¥é“ã€‚

é—®é¢˜ï¼š{question}

èµ„æ–™ï¼š
- {information1}
- {information2}
- {information3}
```

å…¶ä¸­ï¼Œ`{task}`ä»£è¡¨ä»»åŠ¡çš„é¢†åŸŸæˆ–ä¸»é¢˜ï¼Œ`{question}`æ˜¯æœ€ç»ˆè¦å›ç­”çš„é—®é¢˜ï¼Œè€Œ`{information1}`ã€`{information2}`ç­‰åˆ™æ˜¯æä¾›ç»™æ¨¡å‹çš„å¤–éƒ¨çŸ¥è¯†åº“ä¸­çš„å…·ä½“ä¿¡æ¯ã€‚

> RAGå’ŒSFTå¯¹æ¯”

åœ¨æ›´æ–°å¤§å‹è¯­è¨€æ¨¡å‹çš„çŸ¥è¯†æ–¹é¢ï¼Œå¾®è°ƒæ¨¡å‹å’Œä½¿ç”¨RAGè¿™ä¸¤ç§æ–¹æ³•æœ‰ç€å„è‡ªçš„ä¼˜ç¼ºç‚¹ã€‚å¾®è°ƒæ¨¡å‹ä¼˜åŠ¿åœ¨äºèƒ½å¤Ÿé€šè¿‡æœ‰ç›‘ç£å­¦ä¹ çš„æ–¹å¼ï¼Œé€šè¿‡å¯¹ä»»åŠ¡ç›¸å…³æ•°æ®çš„åå¤è¿­ä»£è°ƒæ•´ï¼Œä½¿å¾—æ¨¡å‹æ›´å¥½åœ°é€‚åº”ç‰¹å®šé¢†åŸŸçš„çŸ¥è¯†å’Œè¦æ±‚ã€‚RAGèƒ½å¤Ÿä»å¤–éƒ¨çŸ¥è¯†åº“ä¸­æ£€ç´¢æœ€æ–°ã€å‡†ç¡®çš„ä¿¡æ¯ï¼Œä»è€Œæé«˜äº†ç­”æ¡ˆçš„è´¨é‡å’Œæ—¶æ•ˆæ€§ã€‚å…¶ä¼˜åŠ¿åœ¨äºå¯ä»¥åˆ©ç”¨æœ€æ–°çš„å¤–éƒ¨ä¿¡æ¯ï¼Œä»è€Œæ›´å¥½åœ°é€‚åº”å½“å‰äº‹ä»¶å’ŒçŸ¥è¯†ã€‚

|      | å¾®è°ƒæ¨¡å‹                                               | RAG                                                          |
| ---- | ------------------------------------------------------ | ------------------------------------------------------------ |
| ä¼˜ç‚¹ | é’ˆå¯¹ç‰¹å®šä»»åŠ¡è°ƒæ•´é¢„è®­ç»ƒæ¨¡å‹ã€‚ä¼˜ç‚¹æ˜¯å¯é’ˆå¯¹ç‰¹å®šä»»åŠ¡ä¼˜åŒ–ï¼› | ç»“åˆæ£€ç´¢ç³»ç»Ÿå’Œç”Ÿæˆæ¨¡å‹ã€‚ä¼˜ç‚¹æ˜¯èƒ½åˆ©ç”¨æœ€æ–°ä¿¡æ¯ï¼Œæé«˜ç­”æ¡ˆè´¨é‡ï¼Œå…·æœ‰æ›´å¥½çš„å¯è§£é‡Šæ€§å’Œé€‚åº”æ€§ï¼š |
| ç¼ºç‚¹ | ä½†ç¼ºç‚¹æ˜¯æ›´æ–°æˆæœ¬é«˜ï¼Œå¯¹æ–°ä¿¡æ¯é€‚åº”æ€§è¾ƒå·®ï¼›               | æ˜¯å¯èƒ½é¢ä¸´æ£€ç´¢è´¨é‡é—®é¢˜å’Œæ›¾åŠ é¢å¤–è®¡ç®—èµ„æºéœ€æ±‚;                |

| ç‰¹æ€§       | RAGæŠ€æœ¯                                    | SFTæ¨¡å‹å¾®è°ƒ                              |
| ---------- | ------------------------------------------ | ---------------------------------------- |
| çŸ¥è¯†æ›´æ–°   | å®æ—¶æ›´æ–°æ£€ç´¢åº“ï¼Œé€‚åˆåŠ¨æ€æ•°æ®ï¼Œæ— éœ€é¢‘ç¹é‡è®­ | å­˜å‚¨é™æ€ä¿¡æ¯ï¼Œæ›´æ–°çŸ¥è¯†éœ€è¦é‡æ–°è®­ç»ƒ       |
| å¤–éƒ¨çŸ¥è¯†   | é«˜æ•ˆåˆ©ç”¨å¤–éƒ¨èµ„æºï¼Œé€‚åˆå„ç±»æ•°æ®åº“           | å¯å¯¹é½å¤–éƒ¨çŸ¥è¯†ï¼Œä½†å¯¹åŠ¨æ€æ•°æ®æºä¸å¤Ÿçµæ´»   |
| æ•°æ®å¤„ç†   | æ•°æ®å¤„ç†éœ€æ±‚ä½                             | éœ€æ„å»ºé«˜è´¨é‡æ•°æ®é›†ï¼Œæ•°æ®é™åˆ¶å¯èƒ½å½±å“æ€§èƒ½ |
| æ¨¡å‹å®šåˆ¶åŒ– | ä¸“æ³¨äºä¿¡æ¯æ£€ç´¢å’Œæ•´åˆï¼Œå®šåˆ¶åŒ–ç¨‹åº¦ä½         | å¯å®šåˆ¶è¡Œä¸ºï¼Œé£æ ¼åŠé¢†åŸŸçŸ¥è¯†               |
| å¯è§£é‡Šæ€§   | ç­”æ¡ˆå¯è¿½æº¯ï¼Œè§£é‡Šæ€§é«˜                       | è§£é‡Šæ€§ç›¸å¯¹ä½                             |
| è®¡ç®—èµ„æº   | éœ€è¦æ”¯æŒæ£€ç´¢çš„è®¡ç®—èµ„æºï¼Œç»´æŠ¤å¤–éƒ¨æ•°æ®æº     | éœ€è¦è®­ç»ƒæ•°æ®é›†å’Œå¾®è°ƒèµ„æº                 |
| å»¶è¿Ÿè¦æ±‚   | æ•°æ®æ£€ç´¢å¯èƒ½å¢åŠ å»¶è¿Ÿ                       | å¾®è°ƒåçš„æ¨¡å‹ååº”æ›´å¿«                     |
| å‡å°‘å¹»è§‰   | åŸºäºå®é™…æ•°æ®ï¼Œå¹»è§‰å‡å°‘                     | é€šè¿‡ç‰¹å®šåŸŸè®­ç»ƒå¯å‡å°‘å¹»è§‰ï¼Œä½†ä»ç„¶æœ‰é™     |
| é“å¾·å’Œéšç§ | å¤„ç†å¤–éƒ¨æ–‡æœ¬æ•°æ®æ—¶éœ€è¦è€ƒè™‘éšç§å’Œé“å¾·é—®é¢˜   | è®­ç»ƒæ•°æ®çš„æ•æ„Ÿå†…å®¹å¯èƒ½å¼•å‘éšç§é—®é¢˜       |




> RAGå®ç°æµç¨‹

å¦‚æœä½¿ç”¨RAGï¼Œä¸»è¦åŒ…æ‹¬ä¿¡æ¯æ£€ç´¢å’Œå¤§å‹è¯­è¨€æ¨¡å‹è°ƒç”¨ä¸¤ä¸ªå…³é”®è¿‡ç¨‹ã€‚ä¿¡æ¯æ£€ç´¢é€šè¿‡è¿æ¥å¤–éƒ¨çŸ¥è¯†åº“ï¼Œè·å–ä¸é—®é¢˜ç›¸å…³çš„ä¿¡æ¯ï¼›è€Œå¤§å‹è¯­è¨€æ¨¡å‹è°ƒç”¨åˆ™ç”¨äºå°†è¿™äº›ä¿¡æ¯æ•´åˆåˆ°è‡ªç„¶è¯­è¨€ç”Ÿæˆçš„è¿‡ç¨‹ä¸­ï¼Œä»¥ç”Ÿæˆæœ€ç»ˆçš„å›ç­”ã€‚

| **RAGæµç¨‹** | æè¿° |
|-----------------|-----|
| æ­¥éª¤1ï¼šé—®é¢˜ç†è§£           |å‡†ç¡®æŠŠæ¡ç”¨æˆ·çš„æ„å›¾|
| æ­¥éª¤2ï¼šçŸ¥è¯†æ£€ç´¢         | ä»çŸ¥è¯†åº“ä¸­ç›¸å…³çš„çŸ¥è¯†æ£€ç´¢ |
| æ­¥éª¤3ï¼šç­”æ¡ˆç”Ÿæˆ          |å°†æ£€ç´¢ç»“æœä¸é—®é¢˜ |

RAGæ¯ä¸ªæ­¥éª¤éƒ½é¢ä¸´ä¸€äº›æŒ‘æˆ˜ï¼Œè¿™äº›æŒ‘æˆ˜ä½¿å¾—RAGçš„å®ç°å˜å¾—å¤æ‚è€Œå›°éš¾ã€‚åœ¨é—®é¢˜ç†è§£é˜¶æ®µï¼Œç³»ç»Ÿéœ€è¦å‡†ç¡®æŠŠæ¡ç”¨æˆ·çš„æ„å›¾ã€‚**ç”¨æˆ·æé—®å¾€å¾€æ˜¯çŸ­æ–‡æœ¬ï¼Œè€ŒçŸ¥è¯†åº“ä¸­çš„ä¿¡æ¯å¯èƒ½æ˜¯é•¿æ–‡æœ¬ã€‚** å°†ç”¨æˆ·æé—®ä¸çŸ¥è¯†åº“ä¸­çš„çŸ¥è¯†å»ºç«‹æœ‰æ•ˆçš„å…³è”æ˜¯ä¸€ä¸ªéš¾ç‚¹ï¼Œç‰¹åˆ«æ˜¯è€ƒè™‘åˆ°ç”¨æˆ·æé—®å¯èƒ½æ¨¡ç³Šï¼Œç”¨è¯ä¸è§„èŒƒï¼Œéš¾ä»¥ç›´æ¥æ‰¾åˆ°ç›¸å…³çš„çŸ¥è¯†ã€‚

çŸ¥è¯†æ£€ç´¢æ˜¯RAGæµç¨‹ä¸­çš„å…³é”®æ­¥éª¤ï¼Œä½†ä¹Ÿæ˜¯é¢ä¸´æŒ‘æˆ˜çš„æ­¥éª¤ä¹‹ä¸€ã€‚**ç”¨æˆ·æé—®å¯èƒ½ä»¥å¤šç§æ–¹å¼è¡¨è¾¾ï¼Œè€ŒçŸ¥è¯†åº“çš„ä¿¡æ¯æ¥æºå¯èƒ½æ˜¯å¤šæ ·çš„ï¼ŒåŒ…æ‹¬PDFã€PPTã€Neo4jç­‰æ ¼å¼ã€‚**

**æ­¤å¤–ç”¨æˆ·çš„æ„å›¾å¯èƒ½éå¸¸çµæ´»ï¼Œå¯èƒ½æ˜¯æé—®ï¼Œä¹Ÿå¯èƒ½éœ€è¦è¿›è¡Œé—²èŠ** ã€‚åœ¨è¿™ä¸ªé˜¶æ®µï¼Œéœ€è¦ç¡®ä¿ç”Ÿæˆçš„ç­”æ¡ˆä¸ç”¨æˆ·çš„æ„å›¾ä¸€è‡´ï¼ŒåŒæ—¶ä¿æŒè‡ªç„¶ã€è¿è´¯çš„æ–‡æœ¬ã€‚æ­¤å¤–ï¼Œå¤§å‹æ¨¡å‹çš„è¾“å‡ºå¯èƒ½å­˜åœ¨å¹»è§‰é—®é¢˜ï¼Œå³ç”Ÿæˆçš„å†…å®¹å¯èƒ½ä¸é—®é¢˜ä¸ç›¸å…³ï¼Œå¢åŠ äº†ç”Ÿæˆå‡†ç¡®å›ç­”çš„éš¾åº¦ã€‚

åœ¨è®ºæ–‡ç»¼è¿°[ã€ŒRetrieval-Augmented Generation for Large Language Models: A Surveyã€](https://arxiv.org/pdf/2312.10997.pdf)ä¸­ï¼Œä½œè€…å°†RAGæŠ€æœ¯æŒ‰ç…§å¤æ‚åº¦ç»§ç»­åˆ’åˆ†ä¸ºNaive RAGï¼ŒAdvanced RAGã€Modular RAGã€‚

| **æŠ€æœ¯ç±»å‹** | **æè¿°** |
|-----------------|---------|
| **Naive RAG**   | Naive RAGæ˜¯RAGæŠ€æœ¯çš„æœ€åŸºæœ¬å½¢å¼ï¼Œä¹Ÿè¢«ç§°ä¸ºç»å…¸RAGã€‚åŒ…æ‹¬ç´¢å¼•ã€æ£€ç´¢ã€ç”Ÿæˆä¸‰ä¸ªåŸºæœ¬æ­¥éª¤ã€‚ç´¢å¼•é˜¶æ®µå°†æ–‡æ¡£åº“åˆ†å‰²æˆçŸ­çš„Chunkï¼Œå¹¶æ„å»ºå‘é‡ç´¢å¼•ã€‚æ£€ç´¢é˜¶æ®µæ ¹æ®é—®é¢˜å’ŒChunksçš„ç›¸ä¼¼åº¦æ£€ç´¢ç›¸å…³æ–‡æ¡£ç‰‡æ®µã€‚ç”Ÿæˆé˜¶æ®µä»¥æ£€ç´¢åˆ°çš„ä¸Šä¸‹æ–‡ä¸ºæ¡ä»¶ï¼Œç”Ÿæˆé—®é¢˜çš„å›ç­”ã€‚ |
| **Advanced RAG** | Advanced RAGåœ¨Naive RAGçš„åŸºç¡€ä¸Šè¿›è¡Œä¼˜åŒ–å’Œå¢å¼ºã€‚åŒ…å«é¢å¤–å¤„ç†æ­¥éª¤ï¼Œåˆ†åˆ«åœ¨æ•°æ®ç´¢å¼•ã€æ£€ç´¢å‰å’Œæ£€ç´¢åè¿›è¡Œã€‚åŒ…æ‹¬æ›´ç²¾ç»†çš„æ•°æ®æ¸…æ´—ã€è®¾è®¡æ–‡æ¡£ç»“æ„å’Œæ·»åŠ å…ƒæ•°æ®ï¼Œä»¥æå‡æ–‡æœ¬ä¸€è‡´æ€§ã€å‡†ç¡®æ€§å’Œæ£€ç´¢æ•ˆç‡ã€‚åœ¨æ£€ç´¢å‰ä½¿ç”¨é—®é¢˜çš„é‡å†™ã€è·¯ç”±å’Œæ‰©å……ç­‰æ–¹å¼å¯¹é½é—®é¢˜å’Œæ–‡æ¡£å—ä¹‹é—´çš„è¯­ä¹‰å·®å¼‚ã€‚åœ¨æ£€ç´¢åé€šè¿‡é‡æ’åºé¿å…â€œLost in the Middleâ€ç°è±¡ï¼Œæˆ–é€šè¿‡ä¸Šä¸‹æ–‡ç­›é€‰ä¸å‹ç¼©ç¼©çŸ­çª—å£é•¿åº¦ã€‚ |
| **Modular RAG**  | Modular RAGå¼•å…¥æ›´å¤šå…·ä½“åŠŸèƒ½æ¨¡å—ï¼Œä¾‹å¦‚æŸ¥è¯¢æœç´¢å¼•æ“ã€èåˆå¤šä¸ªå›ç­”ç­‰ã€‚æŠ€æœ¯ä¸Šèåˆäº†æ£€ç´¢ä¸å¾®è°ƒã€å¼ºåŒ–å­¦ä¹ ç­‰ã€‚æµç¨‹ä¸Šå¯¹RAGæ¨¡å—è¿›è¡Œè®¾è®¡å’Œç¼–æ’ï¼Œå‡ºç°å¤šç§ä¸åŒRAGæ¨¡å¼ã€‚æä¾›æ›´å¤§çµæ´»æ€§ï¼Œç³»ç»Ÿå¯ä»¥æ ¹æ®åº”ç”¨éœ€æ±‚é€‰æ‹©åˆé€‚çš„åŠŸèƒ½æ¨¡å—ç»„åˆã€‚æ¨¡å—åŒ–RAGçš„å¼•å…¥ä½¿å¾—ç³»ç»Ÿæ›´è‡ªç”±ã€çµæ´»ï¼Œé€‚åº”ä¸åŒåœºæ™¯å’Œéœ€æ±‚ã€‚ |

åœ¨RAGæŠ€æœ¯æµç¨‹ä¸­ï¼Œæ¶‰åŠå¤šä¸ªå…³é”®æ¨¡å—ï¼Œæ¯ä¸ªæ¨¡å—æ‰¿æ‹…ç€ç‰¹å®šçš„ä»»åŠ¡ï¼ŒååŒå·¥ä½œä»¥å®ç°å‡†ç¡®çš„çŸ¥è¯†æ£€ç´¢å’Œç”Ÿæˆè‡ªç„¶è¯­è¨€å›ç­”ã€‚

| **æŠ€æœ¯æ¨¡å—** | **æè¿°** |
|-----------------|---------|
| **æ„å›¾ç†è§£**   | æ„å›¾ç†è§£æ¨¡å—è´Ÿè´£å‡†ç¡®æŠŠæ¡ç”¨æˆ·æå‡ºçš„é—®é¢˜ï¼Œç¡®å®šç”¨æˆ·çš„æ„å›¾å’Œä¸»é¢˜ã€‚å¤„ç†ç”¨æˆ·æé—®çš„æ¨¡ç³Šæ€§å’Œä¸è§„èŒƒæ€§ï¼Œä¸ºåç»­æµç¨‹æä¾›æ¸…æ™°çš„ä»»åŠ¡ç›®æ ‡ã€‚ |
| **æ–‡æ¡£è§£æ** | æ–‡æ¡£è§£ææ¨¡å—ç”¨äºå¤„ç†æ¥è‡ªä¸åŒæ¥æºçš„æ–‡æ¡£ï¼ŒåŒ…æ‹¬PDFã€PPTã€Neo4jç­‰æ ¼å¼ã€‚è¯¥æ¨¡å—è´Ÿè´£å°†æ–‡æ¡£å†…å®¹è½¬åŒ–ä¸ºå¯å¤„ç†çš„ç»“æ„åŒ–å½¢å¼ï¼Œä¸ºçŸ¥è¯†æ£€ç´¢æä¾›åˆé€‚çš„è¾“å…¥ã€‚ |
| **æ–‡æ¡£ç´¢å¼•**  | æ–‡æ¡£ç´¢å¼•æ¨¡å—å°†è§£æåçš„æ–‡æ¡£åˆ†å‰²æˆçŸ­çš„Chunkï¼Œå¹¶æ„å»ºå‘é‡ç´¢å¼•ã€‚æˆ–é€šè¿‡å…¨æ–‡ç´¢å¼•è¿›è¡Œæ–‡æœ¬æ£€ç´¢ï¼Œä½¿å¾—ç³»ç»Ÿèƒ½å¤Ÿæ›´å¿«é€Ÿåœ°æ‰¾åˆ°ä¸ç”¨æˆ·é—®é¢˜ç›¸å…³çš„æ–‡æ¡£ç‰‡æ®µã€‚ |
| **å‘é‡åµŒå…¥** | å‘é‡åµŒå…¥æ¨¡å—è´Ÿè´£å°†æ–‡æ¡£ç´¢å¼•ä¸­çš„å†…å®¹æ˜ å°„ä¸ºå‘é‡è¡¨ç¤ºï¼Œä»¥ä¾¿åç»­çš„ç›¸ä¼¼åº¦è®¡ç®—ã€‚è¿™æœ‰åŠ©äºæ¨¡å‹æ›´å¥½åœ°ç†è§£æ–‡æ¡£ä¹‹é—´çš„å…³ç³»ï¼Œæé«˜çŸ¥è¯†æ£€ç´¢çš„å‡†ç¡®æ€§ã€‚ |
| **çŸ¥è¯†æ£€ç´¢**   | çŸ¥è¯†æ£€ç´¢æ¨¡å—æ ¹æ®ç”¨æˆ·æé—®å’Œå‘é‡åµŒå…¥è®¡ç®—çš„ç›¸ä¼¼åº¦æ£€ç´¢æˆ–æ–‡æœ¬æ£€ç´¢æ‰“åˆ†ã€‚è¿™ä¸€æ­¥éª¤éœ€è¦è§£å†³é—®é¢˜å’Œæ–‡æ¡£ä¹‹é—´çš„è¯­ä¹‰å…³è”ï¼Œç¡®ä¿æ£€ç´¢çš„å‡†ç¡®æ€§ã€‚ |
| **é‡æ’åº** | é‡æ’åºæ¨¡å—åœ¨çŸ¥è¯†æ£€ç´¢åå¯¹æ–‡æ¡£åº“è¿›è¡Œé‡æ’åºï¼Œä»¥é¿å…â€œLost in the Middleâ€ç°è±¡ï¼Œç¡®ä¿æœ€ç›¸å…³çš„æ–‡æ¡£ç‰‡æ®µåœ¨å‰é¢ã€‚ |
| **å¤§æ¨¡å‹å›ç­”**  | å¤§æ¨¡å‹å›ç­”æ¨¡å—åˆ©ç”¨å¤§å‹è¯­è¨€æ¨¡å‹ç”Ÿæˆæœ€ç»ˆçš„å›ç­”ã€‚è¯¥æ¨¡å—ç»“åˆæ£€ç´¢åˆ°çš„ä¸Šä¸‹æ–‡ï¼Œä»¥ç”Ÿæˆè¿è´¯ã€å‡†ç¡®çš„æ–‡æœ¬å›ç­”ã€‚ |
| **å…¶ä»–åŠŸèƒ½æ¨¡å—** | å¯æ ¹æ®å…·ä½“åº”ç”¨éœ€æ±‚å¼•å…¥å…¶ä»–åŠŸèƒ½æ¨¡å—ï¼Œå¦‚æŸ¥è¯¢æœç´¢å¼•æ“ã€èåˆå¤šä¸ªå›ç­”ç­‰ã€‚æ¨¡å—åŒ–è®¾è®¡ä½¿å¾—ç³»ç»Ÿæ›´åŠ çµæ´»ï¼Œèƒ½å¤Ÿæ ¹æ®ä¸åŒåœºæ™¯é€‰æ‹©åˆé€‚çš„åŠŸèƒ½æ¨¡å—ç»„åˆã€‚ |

### ä»»åŠ¡2ï¼šChatGPT/GLM APIä½¿ç”¨

- ä»»åŠ¡è¯´æ˜ï¼šäº†è§£ChatGPT/GLM APIä½¿ç”¨æ–¹æ³•å’Œé€»è¾‘
- ä»»åŠ¡è¦æ±‚ï¼š
    - èƒ½ä½¿ç”¨APIè¿›è¡Œå¯¹è¯
    - èƒ½ä½¿ç”¨APIè¿›è¡Œæ–‡æœ¬åµŒå…¥
    - èƒ½ä½¿ç”¨APIè¿›è¡Œfunction call
- æ‰“å¡è¦æ±‚ï¼šä½¿ç”¨ChatGPT/GLM APIåˆ†åˆ«å®Œæˆå¯¹è¯ã€åµŒå…¥å’Œfunction callï¼Œå¯¹æ¯”ä¸¤ä¸ªAPIçš„é€Ÿåº¦å’Œå®Œæˆæ•ˆæœã€‚

ChatGPTæ˜¯OpenAIå¼€å‘çš„èŠå¤©ç”Ÿæˆé¢„è®­ç»ƒè½¬æ¢å™¨ï¼ŒåŸºäºGPT-3.5å’ŒGPT-4æ¶æ„ã€‚è¯¥æ¨¡å‹é€šè¿‡å¼ºåŒ–å­¦ä¹ è®­ç»ƒï¼Œå…·æœ‰å‡ºè‰²çš„è¯­è¨€ç”Ÿæˆèƒ½åŠ›ã€‚ChatGPTæ”¯æŒæ–‡å­—æ–¹å¼çš„äº¤äº’ï¼Œç”¨æˆ·å¯ä»¥ä½¿ç”¨è‡ªç„¶è¯­è¨€å¯¹è¯çš„æ–¹å¼ä¸ChatGPTè¿›è¡Œé€šä¿¡ã€‚APIçš„å¼•å…¥ä½¿å¾—å¼€å‘è€…èƒ½å¤Ÿå°†ChatGPTæ•´åˆåˆ°è‡ªå·±çš„åº”ç”¨ä¸­ï¼Œå®ç°è‡ªåŠ¨æ–‡æœ¬ç”Ÿæˆã€è‡ªåŠ¨é—®ç­”ç­‰åŠŸèƒ½ã€‚

GLMæ˜¯æ™ºè°±AIæ¨å‡ºçš„æ–°ä¸€ä»£åŸºåº§å¤§æ¨¡å‹ï¼Œç›¸æ¯”ä¸Šä¸€ä»£æœ‰ç€æ˜¾è‘—æå‡çš„æ€§èƒ½ï¼Œé€¼è¿‘GPT-4ã€‚GLMæ”¯æŒæ›´é•¿çš„ä¸Šä¸‹æ–‡ï¼ˆ128kï¼‰ï¼Œå…·å¤‡å¼ºå¤§çš„å¤šæ¨¡æ€èƒ½åŠ›ï¼Œå¹¶ä¸”æ¨ç†é€Ÿåº¦æ›´å¿«ï¼Œæ”¯æŒæ›´é«˜çš„å¹¶å‘ã€‚GLMçš„APIæ¥å£ä¸ºå¼€å‘è€…æä¾›äº†åœ¨è‡ªå·±åº”ç”¨ä¸­åˆ©ç”¨GLMè¿›è¡Œè¯­è¨€ç”Ÿæˆçš„æœºä¼šï¼Œä¸ºå¤šç§é¢†åŸŸçš„ä»»åŠ¡æä¾›äº†æ–°çš„è§£å†³æ–¹æ¡ˆã€‚

åœ¨ä»»åŠ¡2ä¸­ï¼Œä¸ºäº†æ–¹ä¾¿æ‰€æœ‰åŒå­¦å‚ä¸ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨åœ¨çº¿çš„ChatGPT/GLM APIè¿›è¡Œå¼€å‘ã€‚è¿™ä¸ºæ²¡æœ‰æœ¬åœ°GPUèµ„æºçš„åŒå­¦æä¾›äº†æ›´ä¾¿æ·çš„æ–¹å¼ã€‚ä½†ChatGPT/GLM API éƒ½æ˜¯éœ€è¦æ³¨å†Œè´¦å·å¹¶ä»˜è´¹æ‰èƒ½è¿›è¡Œä½¿ç”¨ï¼Œå¦‚æœä½ æ²¡æœ‰è´¦å·è¯·è”ç³»å°åŠ©æ‰‹ï¼Œæˆ‘ä»¬å°†æƒ³è¦å‚ä¸å­¦ä¹ çš„åŒå­¦æä¾›API tokenã€‚

|                  | **ChatGPT**                                  | **ChatGLM**                                 |
| ---------------- | -------------------------------------------- | ------------------------------------------- |
| **å®˜ç½‘**          | [https://chat.openai.com/](https://chat.openai.com/)  | [https://open.bigmodel.cn/](https://open.bigmodel.cn/) |
| **APIæ–‡æ¡£**       | [https://platform.openai.com/docs/api-reference](https://platform.openai.com/docs/api-reference) | [https://open.bigmodel.cn/dev/api](https://open.bigmodel.cn/dev/api) |
| **APIè®¡è´¹è¯´æ˜**   | [https://openai.com/pricing](https://openai.com/pricing)     | [https://open.bigmodel.cn/pricing](https://open.bigmodel.cn/pricing) |

åœ¨ç»§ç»­åç»­çš„å­¦ä¹ ä¸­ï¼Œæˆ‘ä»¬æå‰æœ‰å¦‚ä¸‹æç¤ºï¼š
1. ChatGPT/GLM APIå¯ä»¥é€šè¿‡Pythonçš„åº“è¿›è¡Œè°ƒç”¨ï¼Œä¹Ÿå¯ä»¥é€šè¿‡HTTPæ–¹å¼è¿›è¡Œè°ƒç”¨ã€‚ä¸ºäº†ä»£ç æ–¹ä¾¿ï¼Œåç»­éƒ½ä½¿ç”¨HTTPæ–¹å¼è°ƒç”¨ã€‚
2. ChatGPT/GLM APIéƒ½æœ‰v3.5å’Œv4ä¸¤ä¸ªå¯¹è¯ç‰ˆæœ¬çš„æ¨¡å‹ï¼Œä½†v4ä»·æ ¼æ¯”v3.5é«˜5-10å€ï¼Œä¸”æ›´æ…¢ã€‚æ‰€ä»¥é™¤éå¿…è¦ï¼Œè¯·é»˜è®¤ä½¿ç”¨v3.5æ¨¡å‹ã€‚
3. ChatGPT APIåœ¨å›½å†…æ— æ³•é“¾æ¥ï¼Œæ•™ç¨‹ä½¿ç”¨äº†[ç¬¬ä¸‰æ–¹å……å€¼å’Œè½¬å‘æ–¹å¼](https://api2d.com/)ã€‚

> å¯¹è¯ API

- è¯·æ±‚å‚æ•°è¯´æ˜

| å‚æ•°                | ç±»å‹                 | å¿…å¡« | æè¿°                                                         |
| ------------------- | -------------------- | ---- | ------------------------------------------------------------ |
| `messages`          | Array                | å¿…å¡« | åŒ…å«å¯¹è¯çš„æ¶ˆæ¯åˆ—è¡¨ã€‚                                         |
| `model`             | String               | å¿…å¡« | è¦ä½¿ç”¨çš„æ¨¡å‹çš„IDã€‚                                           |
| `frequency_penalty` | Number æˆ– null       | å¯é€‰ | æ ¹æ®æ–‡æœ¬ä¸­å·²æœ‰ä»¤ç‰Œçš„é¢‘ç‡å¯¹æ–°ä»¤ç‰Œè¿›è¡Œæƒ©ç½šã€‚å–å€¼èŒƒå›´åœ¨-2.0åˆ°2.0ä¹‹é—´ã€‚ |
| `logit_bias`        | Map                  | å¯é€‰ | ä¿®æ”¹æŒ‡å®šä»¤ç‰Œåœ¨å®Œæˆä¸­å‡ºç°çš„å¯èƒ½æ€§ã€‚æ¥å—ä¸€ä¸ªå°†ä»¤ç‰Œæ˜ å°„åˆ°åç½®å€¼ï¼ˆ-100åˆ°100ï¼‰çš„JSONå¯¹è±¡ã€‚ |
| `logprobs`          | Boolean æˆ– null      | å¯é€‰ | æ˜¯å¦è¿”å›è¾“å‡ºä»¤ç‰Œçš„å¯¹æ•°æ¦‚ç‡ã€‚                                 |
| `top_logprobs`      | Integer æˆ– null      | å¯é€‰ | å¦‚æœ `logprobs` è®¾ç½®ä¸º `true`ï¼Œåˆ™è¿”å›æ¯ä¸ªä»¤ç‰Œä½ç½®ä¸Šæœ€æœ‰å¯èƒ½çš„ä»¤ç‰Œæ•°ï¼Œæ¯ä¸ªéƒ½å¸¦æœ‰å…³è”çš„å¯¹æ•°æ¦‚ç‡ã€‚ |
| `max_tokens`        | Integer æˆ– null      | å¯é€‰ | å¯ä»¥åœ¨èŠå¤©å®Œæˆä¸­ç”Ÿæˆçš„æœ€å¤§ [ä»¤ç‰Œæ•°](https://platform.openai.com/tokenizer)ã€‚ |
| `n`                 | Integer æˆ– null      | å¯é€‰ | ä¸ºæ¯ä¸ªè¾“å…¥æ¶ˆæ¯ç”Ÿæˆçš„èŠå¤©å®Œæˆé€‰æ‹©çš„æ•°é‡ã€‚                     |
| `presence_penalty`  | Number æˆ– null       | å¯é€‰ | æ ¹æ®æ–°ä»¤ç‰Œæ˜¯å¦å‡ºç°åœ¨åˆ°ç›®å‰ä¸ºæ­¢çš„æ–‡æœ¬ä¸­å¯¹å…¶è¿›è¡Œæƒ©ç½šï¼Œå¢åŠ æ¨¡å‹è°ˆè®ºæ–°ä¸»é¢˜çš„å¯èƒ½æ€§ã€‚ |
| `seed`              | Integer æˆ– null      | å¯é€‰ | å¦‚æœæŒ‡å®šï¼Œç³»ç»Ÿå°†å°½åŠ›è¿›è¡Œç¡®å®šæ€§é‡‡æ ·ï¼Œä»¥ä½¿å…·æœ‰ç›¸åŒ `seed` å’Œå‚æ•°çš„é‡å¤è¯·æ±‚åº”è¿”å›ç›¸åŒçš„ç»“æœã€‚ |
| `stop`              | String/Array æˆ– null | å¯é€‰ | API å°†åœæ­¢ç”Ÿæˆè¿›ä¸€æ­¥çš„ä»¤ç‰Œçš„åºåˆ—ï¼Œæœ€å¤šå¯è®¾ç½®ä¸º 4 ä¸ªã€‚        |
| `stream`            | Boolean æˆ– null      | å¯é€‰ | å¦‚æœè®¾ç½®ï¼Œå°†å‘é€éƒ¨åˆ†æ¶ˆæ¯å¢é‡ï¼Œå°±åƒåœ¨ ChatGPT ä¸­ä¸€æ ·ã€‚ä»¤ç‰Œå°†ä½œä¸ºæ•°æ®ä»… [server-sent events](https://developer.mozilla.org/en-US/docs/Web/API/Server-sent_events/Using_server-sent_events#Event_stream_format) å‘é€ï¼Œä¸€æ—¦å¯ç”¨ï¼Œæµå°†ä»¥ `data: [DONE]` æ¶ˆæ¯ç»ˆæ­¢ã€‚å‚è€ƒ [Example Python code](https://cookbook.openai.com/examples/how_to_stream_completions)ã€‚ |
| `temperature`       | Number æˆ– null       | å¯é€‰ | ä½¿ç”¨çš„é‡‡æ ·æ¸©åº¦ï¼Œä»‹äº 0 å’Œ 2 ä¹‹é—´ã€‚è¾ƒé«˜çš„å€¼ï¼ˆå¦‚ 0.8ï¼‰ä¼šä½¿è¾“å‡ºæ›´éšæœºï¼Œè€Œè¾ƒä½çš„å€¼ï¼ˆå¦‚ 0.2ï¼‰ä¼šä½¿å…¶æ›´é›†ä¸­å’Œç¡®å®šæ€§ã€‚ |
| `top_p`             | Number æˆ– null       | å¯é€‰ | ä¸æ¸©åº¦é‡‡æ ·çš„æ›¿ä»£æ–¹æ³•ï¼Œç§°ä¸ºæ ¸é‡‡æ ·ï¼Œå…¶ä¸­æ¨¡å‹è€ƒè™‘å…·æœ‰ top_p æ¦‚ç‡è´¨é‡çš„ä»¤ç‰Œçš„ç»“æœã€‚å› æ­¤ï¼Œ0.1 è¡¨ç¤ºä»…è€ƒè™‘æ„æˆå‰ 10% æ¦‚ç‡è´¨é‡çš„ä»¤ç‰Œã€‚ |

- è¿”å›ç»“æœå­—æ®µ

| å‚æ•°                 | ç±»å‹    | æè¿°                                                                                                             |
|---------------------|---------|------------------------------------------------------------------------------------------------------------------|
| id                  | å­—ç¬¦ä¸²   | ç”¨äºå”¯ä¸€æ ‡è¯†èŠå¤©å®Œæˆçš„æ ‡è¯†ç¬¦ã€‚                                                                                    |
| choices             | æ•°ç»„    | èŠå¤©å®Œæˆé€‰æ‹©çš„åˆ—è¡¨ã€‚å¦‚æœ`n`å¤§äº1ï¼Œåˆ™å¯ä»¥æœ‰å¤šä¸ªé€‰æ‹©ã€‚                                                           |
| created             | æ•´æ•°    | èŠå¤©å®Œæˆåˆ›å»ºçš„Unixæ—¶é—´æˆ³ï¼ˆä»¥ç§’ä¸ºå•ä½ï¼‰ã€‚                                                                          |
| model               | å­—ç¬¦ä¸²   | ç”¨äºèŠå¤©å®Œæˆçš„æ¨¡å‹ã€‚                                                                                             |
| system_fingerprint | å­—ç¬¦ä¸²   | æ­¤æŒ‡çº¹è¡¨ç¤ºæ¨¡å‹è¿è¡Œæ—¶çš„åç«¯é…ç½®ã€‚å¯ä¸seedè¯·æ±‚å‚æ•°ä¸€èµ·ä½¿ç”¨ï¼Œäº†è§£å¯èƒ½å½±å“ç¡®å®šæ€§çš„åç«¯æ›´æ”¹ã€‚                               |
| usage               | å¯¹è±¡    | å®Œæˆè¯·æ±‚çš„ä½¿ç”¨ç»Ÿè®¡ä¿¡æ¯ã€‚                                                                                         |
| finish_reason       | å­—ç¬¦ä¸²   | è¡¨ç¤ºèŠå¤©å®Œæˆçš„åŸå› ã€‚å¯èƒ½çš„å€¼åŒ…æ‹¬"stop"ï¼ˆAPIè¿”å›äº†å®Œæ•´çš„èŠå¤©å®Œæˆè€Œæ²¡æœ‰å—åˆ°ä»»ä½•é™åˆ¶ï¼‰ï¼Œ"length"ï¼ˆç”Ÿæˆè¶…è¿‡äº†max_tokensæˆ–å¯¹è¯è¶…è¿‡äº†max context lengthï¼‰ï¼Œç­‰ç­‰ã€‚  |


- ChatGPTï¼ˆæ”¯æŒgpt-3.5-turbo-0613ã€gpt-3.5-turbo-16k-0613ã€gpt-4-0613ï¼‰

```
import requests

# ä»£ç†åœ°å€ï¼šhttps://oa.api2d.site
url = "https://openai.api2d.net/v1/chat/completions"
headers = {
    'Content-Type': 'application/json',
    'Authorization': 'Bearer å¡«å…¥Key'
}

data = {
    "model": "gpt-3.5-turbo",
    "messages": [{"role": "user", "content": """ä½ å¥½"""},]
}

response = requests.post(url, headers=headers, json=data)
print("Status Code", response.status_code)
print("JSON Response ", response.json())
```




- ChatGLMï¼ˆæ”¯æŒglm-3-turboã€glm-4ï¼‰

```
import time
import jwt
import requests

# å®é™…KEYï¼Œè¿‡æœŸæ—¶é—´
def generate_token(apikey: str, exp_seconds: int):
    try:
        id, secret = apikey.split(".")
    except Exception as e:
        raise Exception("invalid apikey", e)

    payload = {
        "api_key": id,
        "exp": int(round(time.time() * 1000)) + exp_seconds * 1000,
        "timestamp": int(round(time.time() * 1000)),
    }
    return jwt.encode(
        payload,
        secret,
        algorithm="HS256",
        headers={"alg": "HS256", "sign_type": "SIGN"},
    )

url = "https://open.bigmodel.cn/api/paas/v4/chat/completions"
headers = {
  'Content-Type': 'application/json',
  'Authorization': generate_token("å¡«å…¥Key", 1000)
}

data = {
    "model": "glm-3-turbo",
    "messages": [{"role": "user", "content": """ä½ å¥½"""}]
}

response = requests.post(url, headers=headers, json=data)

print("Status Code", response.status_code)
print("JSON Response ", response.json())
```

> Embedding API

- ChatGPT

```
import requests

url = "https://openai.api2d.net/v1/embeddings"

headers = {
  'Content-Type': 'application/json',
  'Authorization': 'Bearer å¡«å…¥Key'
}

data = {
    "model": "text-embedding-ada-002",
    "input": "é­”å…½ä¸–ç•Œåéª‘å»å“ªä¹°"
}
response = requests.post(url, headers=headers, json=data)
print("Status Code", response.status_code)
print("JSON Response ", response.json())
```

- ChatGLM

```
import requests
url = "https://open.bigmodel.cn/api/paas/v4/embeddings"

headers = {
  'Content-Type': 'application/json',
  'Authorization': generate_token("å¡«å…¥Key", 1000)
}

data = {
  "model": "embedding-2",
  "input": "æµ‹è¯•æ–‡æœ¬ï¼Œä»Šå¤©å¾ˆå¼€å¿ƒã€‚"
}

response = requests.post(url, headers=headers, json=data)

print("Status Code", response.status_code)
print("JSON Response ", response.json())
```

> Function call API

- ChatGPT

```
import requests
import json

url = "https://openai.api2d.net/v1/chat/completions"

headers = {
    'Content-Type': 'application/json',
    'Authorization': 'Bearer å¡«å…¥Key'
}

data = {
  "model": "gpt-3.5-turbo-0613", # "gpt-4-0613",
  "messages": [
    {"role": "user", "content": "æåå’Œå°ç‹æ˜¯ä¸æ˜¯è®¤è¯†ï¼Ÿ"},
  ],
  "functions": [
    {
      "name": "get_connection",
      "description": "åˆ¤æ–­ç”¨æˆ·1å’Œç”¨æˆ·2 æ˜¯å¦ä¸ºæœ‹å‹å…³ç³»",
      "parameters": {
        "type": "object",
        "properties": {
          "user_id1": {
            "type": "string",
            "description": "ç”¨æˆ·ID 1"
          },
          "user_id2": {
            "type": "string",
            "description": "ç”¨æˆ·ID 2"
          },
        },
        "required": ["user_id1", "user_id2"]
      }
    }
  ]
}

response = requests.post(url, headers=headers, json=data)
print("Status Code", response.status_code)
print("JSON Response ", response.json())
```

### ä»»åŠ¡3ï¼šè¯»å–æ±½è½¦é—®ç­”æ•°æ®

- ä»»åŠ¡è¯´æ˜ï¼šç†è§£æ•°æ®é›†èƒŒæ™¯å’Œè¯»å–æ•°æ®é›†
- ä»»åŠ¡è¦æ±‚ï¼š
    - ä¸‹è½½æ•°æ®é›†æ–‡ä»¶
    - ä½¿ç”¨å·¥å…·è§£æPDFå†…å®¹
- æ‰“å¡è¦æ±‚ï¼šä½¿ç”¨ä»£ç è§£æPDFæ–‡æ¡£å†…å®¹

æœ¬æ¬¡RAGå­¦ä¹ ä½¿ç”¨äº†[å¤©æ± 2023å…¨çƒæ™ºèƒ½æ±½è½¦AIæŒ‘æˆ˜èµ›â€”â€”èµ›é“ä¸€ï¼šAIå¤§æ¨¡å‹æ£€ç´¢é—®ç­”](https://tianchi.aliyun.com/competition/entrance/532154)çš„æ•°æ®é›†ï¼Œbingè¿›è¡Œäº†é‡æ–°æ ‡æ³¨ã€‚

æ¯”èµ›è¦æ±‚å‚èµ›é€‰æ‰‹ä»¥å¤§æ¨¡å‹ä¸ºä¸­å¿ƒåˆ¶ä½œä¸€ä¸ªé—®ç­”ç³»ç»Ÿï¼Œå›ç­”ç”¨æˆ·çš„æ±½è½¦ç›¸å…³é—®é¢˜ã€‚å‚èµ›é€‰æ‰‹éœ€è¦æ ¹æ®é—®é¢˜ï¼Œåœ¨æ–‡æ¡£ä¸­å®šä½ç›¸å…³ä¿¡æ¯çš„ä½ç½®ï¼Œå¹¶æ ¹æ®æ–‡æ¡£å†…å®¹é€šè¿‡å¤§æ¨¡å‹ç”Ÿæˆç›¸åº”çš„ç­”æ¡ˆã€‚æœ¬æ¬¡æ¯”èµ›æ¶‰åŠçš„é—®é¢˜ä¸»è¦å›´ç»•æ±½è½¦ä½¿ç”¨ã€ç»´ä¿®ã€ä¿å…»ç­‰æ–¹é¢ã€‚

![](https://img.alicdn.com/imgextra/i2/O1CN01Y8GZyc275GPXkHBxX_!!6000000007745-0-tps-311-386.jpg)

```
é—®é¢˜1ï¼šæ€ä¹ˆæ‰“å¼€å±é™©è­¦å‘Šç¯ï¼Ÿ
ç­”æ¡ˆ1ï¼šå±é™©è­¦å‘Šç¯å¼€å…³åœ¨æ–¹å‘ç›˜ä¸‹æ–¹ï¼ŒæŒ‰ä¸‹å¼€å…³å³å¯æ‰“å¼€å±é™©è­¦å‘Šç¯ã€‚

é—®é¢˜2ï¼šè½¦è¾†å¦‚ä½•ä¿å…»ï¼Ÿ
ç­”æ¡ˆ2ï¼šä¸ºäº†ä¿æŒè½¦è¾†å¤„äºæœ€ä½³çŠ¶æ€ï¼Œå»ºè®®æ‚¨å®šæœŸå…³æ³¨è½¦è¾†çŠ¶æ€ï¼ŒåŒ…æ‹¬å®šæœŸä¿å…»ã€æ´—è½¦ã€å†…éƒ¨æ¸…æ´ã€å¤–éƒ¨æ¸…æ´ã€è½®èƒçš„ä¿å…»ã€ä½å‹è“„ç”µæ± çš„ä¿å…»ç­‰ã€‚

é—®é¢˜3ï¼šé èƒŒå¤ªçƒ­æ€ä¹ˆåŠï¼Ÿ
ç­”æ¡ˆ3ï¼šæ‚¨å¥½ï¼Œå¦‚æœæ‚¨çš„åº§æ¤…é èƒŒå¤ªçƒ­ï¼Œå¯ä»¥å°è¯•å…³é—­åº§æ¤…åŠ çƒ­åŠŸèƒ½ã€‚åœ¨å¤šåª’ä½“æ˜¾ç¤ºå±ä¸Šä¾æ¬¡ç‚¹å‡»ç©ºè°ƒå¼€å¯æŒ‰é”®â†’åº§æ¤…â†’åŠ çƒ­ï¼Œåœ¨è¯¥ç•Œé¢ä¸‹å¯ä»¥å…³é—­åº§æ¤…åŠ çƒ­ã€‚
```

æ•°æ®é›†ä¸‹è½½åœ°å€ï¼š
- æ•°æ®ï¼ˆç™¾åº¦äº‘ç›˜ï¼‰é“¾æ¥: https://pan.baidu.com/s/19_oqY4bC_lJa_7Mc6lxU7w?pwd=v4bi æå–ç : v4bi
- æ•°æ®ï¼ˆè°·æ­Œäº‘ç›˜ï¼‰é“¾æ¥ï¼šhttps://drive.google.com/drive/folders/1rD52-7W5ypzLk9ZXOrMBYx8F8xHaAzlW?usp=sharing


> è¯»å–é—®ç­”æ•°æ®é›†

```
import json
import pdfplumber

questions = json.load(open("questions.json"))
print(questions[0])

pdf = pdfplumber.open("åˆèµ›è®­ç»ƒæ•°æ®é›†.pdf")
len(pdf.pages) # é¡µæ•°
pdf.pages[0].extract_text() # è¯»å–ç¬¬ä¸€é¡µå†…å®¹
```

> è¯»å–æ‰€æœ‰é¡µå†…å®¹

```
pdf_content = []
for page_idx in range(len(pdf.pages)):
    pdf_content.append({
        'page': 'page_' + str(page_idx + 1),
        'content': pdf.pages[page_idx].extract_text()
    })
```

### ä»»åŠ¡4ï¼šæ–‡æœ¬ç´¢å¼•ä¸ç­”æ¡ˆæ£€ç´¢

- ä»»åŠ¡è¯´æ˜ï¼šæ–‡æœ¬æ–‡æœ¬ç´¢å¼•çš„å®ç°é€»è¾‘
- ä»»åŠ¡è¦æ±‚ï¼š
    - ç†è§£å€’æ’ç´¢å¼•
    - å®ç°TFIDFå’ŒBM25çš„ç¼–ç ä¸æ£€ç´¢
- æ‰“å¡è¦æ±‚ï¼šä½¿ç”¨TFIDFå’ŒBM25è¿›è¡Œæ£€ç´¢

> TFIDF

```
import jieba
import numpy as np
from sklearn.feature_extraction.text import TfidfVectorizer
from sklearn.preprocessing import normalize

question_words = [' '.join(jieba.lcut(x['question'])) for x in questions]
pdf_content_words = [' '.join(jieba.lcut(x['content'])) for x in pdf_content]

tfidf = TfidfVectorizer()
tfidf.fit(question_words + pdf_content_words)

question_feat = tfidf.transform(question_words)
pdf_content_feat = tfidf.transform(pdf_content_words)

question_feat = normalize(question_feat)
pdf_content_feat = normalize(pdf_content_feat)

for query_idx, feat in enumerate(question_feat):
    score = feat @ pdf_content_feat.T
    score = score.toarray()[0]
    max_score_page_idx = score.argsort()[-1] + 1

    questions[query_idx]['reference'] = 'page_' + str(max_score_page_idx)

with open('submit.json', 'w', encoding='utf8') as up:
    json.dump(questions, up, ensure_ascii=False, indent=4)
```

> BM25
```
# !pip install rank_bm25
from rank_bm25 import BM25Okapi

pdf_content_words = [jieba.lcut(x['content']) for x in pdf_content]
bm25 = BM25Okapi(pdf_content_words)

for query_idx in range(len(questions)):
    doc_scores = bm25.get_scores(jieba.lcut(questions[query_idx]["question"]))
    max_score_page_idx = doc_scores.argsort()[-1] + 1
    questions[query_idx]['reference'] = 'page_' + str(max_score_page_idx)

with open('submit.json', 'w', encoding='utf8') as up:
    json.dump(questions, up, ensure_ascii=False, indent=4)
```

### ä»»åŠ¡5ï¼šæ–‡æœ¬åµŒå…¥ä¸å‘é‡æ£€ç´¢

- ä»»åŠ¡è¯´æ˜ï¼šå¯¹æ–‡æœ¬è¿›è¡Œç¼–ç ï¼Œå¹¶è¿›è¡Œè¯­ä¹‰æ£€ç´¢
- ä»»åŠ¡è¦æ±‚ï¼š
    - åŠ è½½æ–‡æœ¬ç¼–ç æ¨¡å‹
    - å¯¹æé—®å’Œæ–‡æ¡£è¿›è¡Œç¼–ç ï¼Œå¹¶è¿›è¡Œæ£€ç´¢
- æ‰“å¡è¦æ±‚ï¼šåŠ è½½ä¸‰ä¸ªç¼–ç æ¨¡å‹ï¼Œè®¡ç®—æ£€ç´¢ç»“æœ

- M3E

```
from sentence_transformers import SentenceTransformer
model = SentenceTransformer('../hugging-face-model/moka-ai/m3e-small/')

question_sentences = [x['question'] for x in questions]
pdf_content_sentences = [x['content'] for x in pdf_content]

question_embeddings = model.encode(question_sentences, normalize_embeddings=True)
pdf_embeddings = model.encode(pdf_content_sentences, normalize_embeddings=True)

for query_idx, feat in enumerate(question_embeddings):
    score = feat @ pdf_embeddings.T
    max_score_page_idx = score.argsort()[-1] + 1
    questions[query_idx]['reference'] = 'page_' + str(max_score_page_idx)
with open('submit.json', 'w', encoding='utf8') as up:
    json.dump(questions, up, ensure_ascii=False, indent=4)
```

- BGE

```
model = SentenceTransformer('../hugging-face-model/BAAI/bge-small-zh-v1.5/')
```

- BCEmbedding

```
model = SentenceTransformer("../hugging-face-model/maidalun1020/bce-embedding-base_v1", device='cuda')
model.max_seq_length = 512
```

### ä»»åŠ¡6ï¼šæ–‡æœ¬å¤šè·¯å¬å›ä¸é‡æ’åº

- ä»»åŠ¡è¯´æ˜ï¼šå®ç°å¤šç§æ–‡æœ¬ç¼–ç å’Œæ£€ç´¢é€»è¾‘ï¼Œå¹¶è¿›è¡Œé‡æ’åº
- ä»»åŠ¡è¦æ±‚ï¼š
    - ç»“åˆæ–‡æœ¬ç´¢å¼•å’Œå‘é‡æ£€ç´¢ç»“æœ
    - åŠ è½½é‡æ’åºæ¨¡å‹ï¼Œå¯¹æ£€ç´¢è¿›è¡Œé‡æ’åº
- æ‰“å¡è¦æ±‚ï¼šå®Œæˆå¤šè·¯å¬å›ä¸é‡æ’åºï¼Œä¸ä»»åŠ¡5ç²¾åº¦è¿›è¡Œå¯¹æ¯”

- BM25 + BGE Rerank

```
import jieba, json, pdfplumber
import numpy as np
from sklearn.feature_extraction.text import TfidfVectorizer
from sklearn.preprocessing import normalize
from rank_bm25 import BM25Okapi

questions = json.load(open("questions.json"))

pdf = pdfplumber.open("åˆèµ›è®­ç»ƒæ•°æ®é›†.pdf")
pdf_content = []
for page_idx in range(len(pdf.pages)):
    pdf_content.append({
        'page': 'page_' + str(page_idx + 1),
        'content': pdf.pages[page_idx].extract_text()
    })

import torch
from transformers import AutoModelForSequenceClassification, AutoTokenizer

tokenizer = AutoTokenizer.from_pretrained('../hugging-face-model/BAAI/bge-reranker-base/')
rerank_model = AutoModelForSequenceClassification.from_pretrained('../hugging-face-model/BAAI/bge-reranker-base/')
rerank_model.cuda()

pdf_content_words = [jieba.lcut(x['content']) for x in pdf_content]
bm25 = BM25Okapi(pdf_content_words)

for query_idx in range(len(questions)):
    doc_scores = bm25.get_scores(jieba.lcut(questions[query_idx]["question"]))
    max_score_page_idxs = doc_scores.argsort()[-3:]

    pairs = []
    for idx in max_score_page_idxs:
        pairs.append([questions[query_idx]["question"], pdf_content[idx]['content']])

    inputs = tokenizer(pairs, padding=True, truncation=True, return_tensors='pt', max_length=512)
    with torch.no_grad():
        inputs = {key: inputs[key].cuda() for key in inputs.keys()}
        scores = rerank_model(**inputs, return_dict=True).logits.view(-1, ).float()

    max_score_page_idx = max_score_page_idxs[scores.cpu().numpy().argmax()]
    questions[query_idx]['reference'] = 'page_' + str(max_score_page_idx + 1)

with open('submit.json', 'w', encoding='utf8') as up:
    json.dump(questions, up, ensure_ascii=False, indent=4)
```

### ä»»åŠ¡7ï¼šæ–‡æœ¬é—®ç­”Promoptä¼˜åŒ–

- ä»»åŠ¡è¯´æ˜ï¼šå°†æ£€ç´¢ç»“æœç»“åˆé—®é¢˜æ„é€ promotï¼Œå®Œæˆé—®ç­”
- ä»»åŠ¡è¦æ±‚ï¼š
    - æ„é€ prompt
    - è°ƒç”¨APIè¿›è¡Œé—®ç­”
- æ‰“å¡è¦æ±‚ï¼šå®ŒæˆRAGå®Œæ•´æµç¨‹ï¼Œå¹¶æäº¤ç»“æœè¿›è¡Œæ‰“åˆ†

- BM25 + BGE Rerank + GLM

```
def ask_glm(content):
    url = "https://open.bigmodel.cn/api/paas/v4/chat/completions"
    headers = {
      'Content-Type': 'application/json',
      'Authorization': generate_token("å¡«å†™key", 1000)
    }

    data = {
        "model": "glm-3-turbo",
        "messages": [{"role": "user", "content": content}]
    }

    response = requests.post(url, headers=headers, json=data)
    return response.json()

pdf_content_words = [jieba.lcut(x['content']) for x in pdf_content]
bm25 = BM25Okapi(pdf_content_words)

for query_idx in range(len(questions)):
    doc_scores = bm25.get_scores(jieba.lcut(questions[query_idx]["question"]))
    max_score_page_idxs = doc_scores.argsort()[-3:]

    pairs = []
    for idx in max_score_page_idxs:
        pairs.append([questions[query_idx]["question"], pdf_content[idx]['content']])

    inputs = tokenizer(pairs, padding=True, truncation=True, return_tensors='pt', max_length=512)
    with torch.no_grad():
        inputs = {key: inputs[key].cuda() for key in inputs.keys()}
        scores = rerank_model(**inputs, return_dict=True).logits.view(-1, ).float()
    max_score_page_idx = max_score_page_idxs[scores.cpu().numpy().argmax()]
    questions[query_idx]['reference'] = 'page_' + str(max_score_page_idx + 1)

    prompt = '''ä½ æ˜¯ä¸€ä¸ªæ±½è½¦ä¸“å®¶ï¼Œå¸®æˆ‘ç»“åˆç»™å®šçš„èµ„æ–™ï¼Œå›ç­”ä¸€ä¸ªé—®é¢˜ã€‚å¦‚æœé—®é¢˜æ— æ³•ä»èµ„æ–™ä¸­è·å¾—ï¼Œè¯·è¾“å‡ºç»“åˆç»™å®šçš„èµ„æ–™ï¼Œæ— æ³•å›ç­”é—®é¢˜ã€‚
èµ„æ–™ï¼š{0}

é—®é¢˜ï¼š{1}
    '''.format(
        pdf_content[max_score_page_idx]['content'],
        questions[query_idx]["question"]
    )
    answer = ask_glm(prompt)['choices'][0]['message']['content']
    questions[query_idx]['answer'] = answer
```

### ã€ğŸ“å¾…è¡¥å……ã€‘ä»»åŠ¡8ï¼šé—®ç­”æ„å›¾è¯†åˆ«ï¼ˆè¿›é˜¶æ–¹å‘ï¼‰

### ã€ğŸ“å¾…è¡¥å……ã€‘ä»»åŠ¡9ï¼šé—®ç­”å…³é”®è¯æå–ï¼ˆè¿›é˜¶æ–¹å‘ï¼‰

### ã€ğŸ“å¾…è¡¥å……ã€‘ä»»åŠ¡10ï¼šæ‰©å±•è¯ä¸æ‰©å±•æŸ¥è¯¢ï¼ˆè¿›é˜¶æ–¹å‘ï¼‰

### ã€ğŸ“å¾…è¡¥å……ã€‘ä»»åŠ¡11ï¼šæœ¬åœ°å¾®è°ƒChatGLMï¼ˆè¿›é˜¶æ–¹å‘ï¼‰

### ä¸“ä¸šåè¯ä»‹ç»

| **ä¸“ä¸šåè¯**                    | **æè¿°**                                                                                                                                                                                            |
|-----------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| å¤§å‹è¯­è¨€æ¨¡å‹                   | åœ¨è‡ªç„¶è¯­è¨€å¤„ç†é¢†åŸŸå±•ç¤ºå‡ºå¼ºå¤§ç”Ÿæˆèƒ½åŠ›çš„æ¨¡å‹ï¼Œå¦‚GPTç³»åˆ—ã€‚ä½†å…¶ä¿®æ”¹ã€å¾®è°ƒæˆ–é‡æ–°è®­ç»ƒå›°éš¾ï¼Œæˆæœ¬é«˜ã€‚                                                                                                                |
| Prompt                        | "Prompt"ï¼ˆæç¤ºï¼‰æ˜¯æŒ‡ä¸€ç§å¼•å¯¼å¤§å‹è¯­è¨€æ¨¡å‹ï¼ˆLLMï¼‰ç”Ÿæˆç‰¹å®šæ–‡æœ¬çš„æ–¹æ³•ã€‚æˆ–å¯ä»¥ç†è§£ä¸ºè¾“ç»™å¤§æ¨¡å‹çš„è¾“å…¥æ–‡æœ¬ã€‚                                                                                                                |
| å¹»è§‰ï¼ˆHallucinationï¼‰          | åœ¨è‡ªç„¶è¯­è¨€å¤„ç†é¢†åŸŸè¢«å®šä¹‰ä¸ºç”Ÿæˆçš„å†…å®¹ä¸æä¾›çš„æºå†…å®¹æ— å…³æˆ–ä¸å¿ å®ï¼Œä¸€ç§è™šå‡çš„æ„ŸçŸ¥ã€‚                                             |
| çŸ¥è¯†åº“é—®ç­”ï¼ˆKBQAï¼‰              | æ—©æœŸçš„å¯¹è¯ç³»ç»Ÿæ–¹æ³•ï¼Œåˆ©ç”¨ç»“æ„åŒ–çš„çŸ¥è¯†åº“è¿›è¡Œè‡ªç„¶è¯­è¨€é—®é¢˜çš„å›ç­”ã€‚çŸ¥è¯†åº“ä»¥ä¸‰å…ƒç»„å½¢å¼è¡¨ç¤º<ä¸»é¢˜ï¼Œå…³ç³»ï¼Œå¯¹è±¡>ï¼Œå­˜å‚¨åœ¨å›¾æ•°æ®åº“ä¸­ã€‚                       |
| RAG         | RAGæ˜¯æ£€ç´¢å¢å¼ºç”Ÿæˆï¼ˆRetrieval-augmented Generationï¼‰çš„ç¼©å†™ï¼Œæ˜¯ä¸€ç§ç»“åˆäº†å¤§å‹è¯­è¨€æ¨¡å‹çš„ç”Ÿæˆèƒ½åŠ›å’Œæ£€ç´¢ç³»ç»Ÿçš„ç²¾ç¡®æ€§çš„æŠ€æœ¯ï¼Œç”¨äºæé«˜ç”Ÿæˆå†…å®¹çš„å‡†ç¡®æ€§ã€ç›¸å…³æ€§å’Œæ—¶æ•ˆæ€§ã€‚                                                                                                    |
| å€’æ’ç´¢å¼•      | å€’æ’ç´¢å¼•ï¼ˆInverted Indexï¼‰æ˜¯ä¸€ç§æ•°æ®ç»“æ„ï¼Œç”¨äºåŠ é€Ÿæ–‡æœ¬æ£€ç´¢è¿‡ç¨‹ã€‚å®ƒå°†æ–‡æ¡£ä¸­çš„è¯æ±‡æ˜ å°„åˆ°å‡ºç°è¯¥è¯æ±‡çš„æ–‡æ¡£åˆ—è¡¨ï¼Œä»è€Œå®ç°æ ¹æ®è¯æ±‡å¿«é€Ÿæ£€ç´¢ç›¸å…³æ–‡æ¡£çš„ç›®çš„ã€‚                                                  |
| æ–‡æœ¬åµŒå…¥      | æ–‡æœ¬åµŒå…¥æ˜¯å°†æ–‡æœ¬ä¿¡æ¯æ˜ å°„åˆ°é«˜ç»´å‘é‡ç©ºé—´çš„è¿‡ç¨‹ï¼Œä½¿å¾—å…·æœ‰è¯­ä¹‰ç›¸ä¼¼æ€§çš„æ–‡æœ¬åœ¨å‘é‡ç©ºé—´ä¸­è·ç¦»è¾ƒè¿‘ã€‚                                                  |
| æ–‡æœ¬ç›¸ä¼¼åº¦    | æ–‡æœ¬ç›¸ä¼¼åº¦æ˜¯è¡¡é‡ä¸¤æ®µæ–‡æœ¬ä¹‹é—´è¯­ä¹‰æ¥è¿‘ç¨‹åº¦çš„åº¦é‡ã€‚é€šè¿‡è®¡ç®—æ–‡æœ¬åœ¨åµŒå…¥ç©ºé—´ä¸­çš„ç›¸ä¼¼æ€§ï¼Œå¯ä»¥è¯„ä¼°å®ƒä»¬åœ¨è¯­ä¹‰ä¸Šçš„ç›¸ä¼¼ç¨‹åº¦ã€‚                                                          |
| æ’åºä¸é‡æ’åº   | åœ¨ä¿¡æ¯æ£€ç´¢ä¸­ï¼Œæ’åºæŒ‡çš„æ˜¯å°†æ£€ç´¢åˆ°çš„æ–‡æ¡£æŒ‰ç…§å…¶ä¸æŸ¥è¯¢çš„ç›¸å…³æ€§è¿›è¡Œæ’åºã€‚é‡æ’åºåˆ™æ˜¯åœ¨æ’åºåçš„ç»“æœåŸºç¡€ä¸Šå†æ¬¡è°ƒæ•´æ–‡æ¡£çš„é¡ºåºï¼Œä»¥è¿›ä¸€æ­¥æé«˜ä¸ç”¨æˆ·æŸ¥è¯¢çš„åŒ¹é…åº¦ã€‚                                                  |